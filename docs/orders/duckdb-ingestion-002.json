{
  "order_id": "duckdb-ingestion-002",
  "priority": "high",
  "version": "v1.0",
  "supercontext": {
    "repository": "docling_langextract_testing",
    "mission": "Finalize DuckDB ingestion by closing documentation/status gaps and providing run evidence without committing database artifacts."
  },
  "goal": "Mark the ingestion plan as complete, capture an execution run with evidence, and ensure users can reproduce ingestion and queries locally.",
  "execution_instructions": [
    "Do not commit any .duckdb files; keep them in .gitignore (already configured).",
    "Use the existing scripts (ingest_metadata_to_duckdb.py, query_duckdb.py) and tests to generate evidence.",
    "Keep changes focused on documentation, evidence capture, and minimal polish."
  ],
  "tasks": [
    {
      "id": "status-update",
      "description": "Update plan document status to COMPLETE with date and brief summary.",
      "steps": [
        "Edit docs/reports/duckdb-ingestion-plan.md: change Status from 'In Progress' to 'Complete'.",
        "Append a short 'What shipped' bullet list linking to scripts and tests."
      ]
    },
    {
      "id": "run-evidence",
      "description": "Execute ingestion locally and capture evidence.",
      "steps": [
        "Run a dry run over metadata: uv run python scripts/ingest_metadata_to_duckdb.py --db runs.duckdb --glob 'output/**/*_metadata.json' --dry-run",
        "Run real ingestion: uv run python scripts/ingest_metadata_to_duckdb.py --db runs.duckdb --glob 'output/**/*_metadata.json'",
        "Run stats queries: uv run python scripts/query_duckdb.py --db runs.duckdb --query stats",
        "Save terminal outputs and summary counts to docs/reports/duckdb-ingestion-run.md (commands, discovered files, inserted rows, distinct providers/models)."
      ]
    },
    {
      "id": "quickstart-docs",
      "description": "Add a brief Quickstart section to the plan with copy-paste commands.",
      "steps": [
        "In docs/reports/duckdb-ingestion-plan.md, add a 'Quickstart' subsection with the three commands (dry-run, ingest, query).",
        "Link to docs/reports/duckdb-queries.sql for additional examples."
      ]
    },
    {
      "id": "sanity-test",
      "description": "Run the unit tests to verify schema and ingestion integrity.",
      "steps": [
        "Execute: uv run python -m pytest -q tests/test_duckdb_ingestion.py",
        "Record a one-line pass/fail note in docs/reports/duckdb-ingestion-run.md"
      ]
    }
  ],
  "acceptance_criteria": [
    "docs/reports/duckdb-ingestion-plan.md shows Status: Complete with date and 'What shipped' bullets.",
    "docs/reports/duckdb-ingestion-run.md exists and contains: commands executed, discovered file count, success/error counts, total rows in pipeline_runs, distinct providers/models, and a pasted 'stats' query result.",
    "Running the Quickstart commands on a fresh environment produces the same table and basic query results (allowing for local differences in metadata files).",
    "tests/test_duckdb_ingestion.py passes locally (or is documented as skipped if duckdb is unavailable)."
  ],
  "constraints": {
    "what_not_to_do": [
      "Do not change schema or ingestion logic in this order (only docs/evidence).",
      "Do not commit any .duckdb database files.",
      "Do not wire Streamlit to write to DuckDB in this order."
    ],
    "notes": "If no metadata files are present under output/, run dry-run and document '0 files discovered' gracefully."
  },
  "testing": {
    "required_commands": [
      "uv run python scripts/ingest_metadata_to_duckdb.py --help",
      "uv run python scripts/ingest_metadata_to_duckdb.py --db runs.duckdb --glob 'output/**/*_metadata.json' --dry-run",
      "uv run python scripts/ingest_metadata_to_duckdb.py --db runs.duckdb --glob 'output/**/*_metadata.json'",
      "uv run python scripts/query_duckdb.py --db runs.duckdb --query stats",
      "uv run python -m pytest -q tests/test_duckdb_ingestion.py"
    ],
    "artifacts": [
      "docs/reports/duckdb-ingestion-run.md"
    ]
  },
  "metadata": {
    "created_at": "2025-10-18T00:00:00Z",
    "created_by": "agent",
    "status": "draft"
  }
}

